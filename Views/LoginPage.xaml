<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:FinanzasApp.ViewModels"
             x:Class="FinanzasApp.Views.LoginPage"
             x:DataType="viewModels:LoginViewModel"
             Shell.NavBarIsVisible="False">

    <Grid IgnoreSafeArea="True">
        <!-- Fondo degradado y halos -->
        <Grid InputTransparent="True">
            <Ellipse x:Name="BlueBlob"
                     WidthRequest="280"
                     HeightRequest="280"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,-80,-40,0"
                     Opacity="0.45">
                <Ellipse.Fill>
                    <RadialGradientBrush Center="0.2,0.2" Radius="0.9">
                        <GradientStop Color="#57AEFF" Offset="0.0" />
                        <GradientStop Color="#00000000" Offset="1.0" />
                    </RadialGradientBrush>
                </Ellipse.Fill>
            </Ellipse>

            <Ellipse x:Name="PurpleBlob"
                     WidthRequest="360"
                     HeightRequest="360"
                     HorizontalOptions="Start"
                     VerticalOptions="End"
                     Margin="-80,0,0,-120"
                     Opacity="0.5">
                <Ellipse.Fill>
                    <RadialGradientBrush Center="0.7,0.8" Radius="1.0">
                        <GradientStop Color="#8B5CF6" Offset="0.0" />
                        <GradientStop Color="#00000000" Offset="1.0" />
                    </RadialGradientBrush>
                </Ellipse.Fill>
            </Ellipse>
        </Grid>

        <!-- Contenido -->
        <ScrollView VerticalScrollBarVisibility="Never">
            <VerticalStackLayout x:Name="LoginContainer"
                                 Padding="26,52"
                                 Spacing="24"
                                 VerticalOptions="Center">

                <VerticalStackLayout Spacing="4" HorizontalOptions="Center">
                    <Label Text="FinanzasApp" Style="{StaticResource TitleLabelStyle}" />
                    <Label Text="Acceso" Style="{StaticResource SubTitleLabelStyle}" />
                </VerticalStackLayout>

                <Border Style="{StaticResource CardBorderStyle}" Padding="18,20" StrokeThickness="0.6" Stroke="#1F2A44">
                    <VerticalStackLayout Spacing="16">
                        <VerticalStackLayout Spacing="12">
                            <Border Style="{StaticResource InputBorderStyle}" x:Name="UserBorder">
                                <Grid ColumnDefinitions="40,*" VerticalOptions="Center" HeightRequest="52">
                                    <Label Text="游녻" FontSize="18" VerticalOptions="Center" HorizontalOptions="Center" />
                                    <Entry x:Name="UserEntry"
                                           Grid.Column="1"
                                           Placeholder="Usuario"
                                           Text="{Binding Username}"
                                           Style="{StaticResource InputEntryStyle}"
                                           Focused="OnInputFocused"
                                           Unfocused="OnInputUnfocused" />
                                </Grid>
                            </Border>

                            <Border Style="{StaticResource InputBorderStyle}" x:Name="PasswordBorder">
                                <Grid ColumnDefinitions="40,*" VerticalOptions="Center" HeightRequest="52">
                                    <Label Text="游" FontSize="18" VerticalOptions="Center" HorizontalOptions="Center" />
                                    <Entry x:Name="PasswordEntry"
                                           Grid.Column="1"
                                           Placeholder="Contrase침a"
                                           IsPassword="True"
                                           Text="{Binding Password}"
                                           Style="{StaticResource InputEntryStyle}"
                                           Focused="OnInputFocused"
                                           Unfocused="OnInputUnfocused" />
                                </Grid>
                            </Border>
                        </VerticalStackLayout>

                        <!-- Tips din치micos -->
                        <Border BackgroundColor="#0B1220" StrokeThickness="0" StrokeShape="RoundRectangle 14" Padding="14,10">
                            <VerticalStackLayout Spacing="6">
                                <Label Text="Tip"
                                       FontAttributes="Bold"
                                       TextColor="{StaticResource AccentPurple}" />
                                <Label x:Name="DefaultTip"
                                       Text="Mant칠n tus finanzas ordenadas y revisa tus movimientos a diario."
                                       TextColor="{StaticResource TextGray}">
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference UserEntry}, Path=IsFocused}" Value="True">
                                            <Setter Property="IsVisible" Value="False" />
                                        </DataTrigger>
                                        <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference PasswordEntry}, Path=IsFocused}" Value="True">
                                            <Setter Property="IsVisible" Value="False" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>

                                <Label x:Name="UserTip"
                                       Text="Usa un nombre 칰nico; as칤 podr치s identificar tus datos f치cilmente."
                                       TextColor="{StaticResource TextGray}" IsVisible="False">
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference UserEntry}, Path=IsFocused}" Value="True">
                                            <Setter Property="IsVisible" Value="True" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>

                                <Label x:Name="PasswordTip"
                                       Text="Crea una contrase침a segura combinando n칰meros y letras."
                                       TextColor="{StaticResource TextGray}" IsVisible="False">
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label" Binding="{Binding Source={x:Reference PasswordEntry}, Path=IsFocused}" Value="True">
                                            <Setter Property="IsVisible" Value="True" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>
                            </VerticalStackLayout>
                        </Border>

                        <Button Text="Entrar" Style="{StaticResource PrimaryButtonStyle}" Command="{Binding LoginCommand}" />
                        <Button Text="Crear cuenta" Style="{StaticResource SecondaryButtonStyle}" Command="{Binding RegisterCommand}" />

                        <Label Text="{Binding Message}" TextColor="#FF6B9C" FontAttributes="Bold" HorizontalTextAlignment="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label" Binding="{Binding Message}" Value="">
                                    <Setter Property="IsVisible" Value="False" />
                                </DataTrigger>
                                <DataTrigger TargetType="Label" Binding="{Binding Message}" Value="{x:Null}">
                                    <Setter Property="IsVisible" Value="False" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </VerticalStackLayout>
                </Border>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
